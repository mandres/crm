<div id="confirmar"></div>
<div id="buscar"></div>
<div id="panelPrograma" class="panel panel-default">
    <div class="panel-heading centrado">Administrar Permisos</div>
    <div class="panel-body">
        <div id="mesajes"></div>
        <form id="formPrograma">
            <input type="hidden" id="bpagina" name="bpagina" value="1" />
            <div class="row">
                <div class="col-xs-3 col-md-2 col-lg-1">
                    <span>Rol</span>
                </div>
                <div class="col-xs-6 col-md-3 col-lg-2">
                    <input id="id_rol" name="id_rol" type="text" class="form-control input-sm" placeholder="Id Rol">
                </div>
                <div class="col-xs-3 col-md-3 col-lg-1">
                    <button id="botonBuscarIdRol" type="button" class="btn btn-primary btn-sm"><span class="glyphicon glyphicon-search"></span></button>
                </div>
                <div class="col-xs-12 col-sm-9 col-md-12 col-lg-8">
                    <input id="nombre_rol" name="nombre_rol" type="text" class="form-control input-sm" placeholder="Nombre Rol" disabled="disabled">
                </div>
            </div>
        </form>
        <br>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="table-conteiner">
                    <table class="table table-bordered table-striped table-hover">
                        <colgroup>
                            <col style="width: 18%;"/>
                            <col style="width: 22%;"/>
                            <col style="width: 10%;"/>
                            <col style="width: 10%;"/>
                            <col style="width: 10%;"/>
                            <col style="width: 10%;"/>
                            <col style="width: 20%;"/>
                        </colgroup>
                        <thead>
                            <tr>
                                <th>Id</th>
                                <th>Formulario</th>
                                <th>Agregar</th>
                                <th>Modificar</th>
                                <th>Eliminar</th>
                                <th>Listar</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tr>
                            <td>
                                <div class="row">
                                    <div class="col-md-8">
                                        <input id="id_formulario" name="id_formulario" type="text" class="form-control input-sm">
                                    </div>
                                    <div class="col-md-4">
                                        <button id="botonBuscarIdFormulario" type="button" class="btn btn-primary btn-sm">
                                            <span class="glyphicon glyphicon-search"></span></button>
                                    </div>
                                </div>
                            </td>
                            <td><input id="nombre_formulario" name="nombre_formulario" type="text" class="form-control input-sm" placeholder="Nombre Formulario" disabled="disabled"></td>
                            <td><input type="checkbox" value=""></td>
                            <td><input type="checkbox" value=""></td>
                            <td><input type="checkbox" value=""></td>
                            <td><input type="checkbox" value=""></td>
                            <td><button id="btn-agregar-permiso" type="button" class="btn btn-default"><span class="icon-agregar"></span></button></td>
                        </tr>
                        <tbody id="tbody-permisos">
                            <tr><td  colspan=9>Seleccione un Rol para recuperar los permisos asignados</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="panel-footer centrado">
        <div class="progress progress-striped active" id="estadoServidor">
            <div class="progress-bar" role="progressbar"
                 aria-valuenow="45" aria-valuemin="0" aria-valuemax="100"
                 style="width: 100%">
                <span class="sr-only"></span>
            </div>
        </div>
        <button id="botonSalir" type="button" class="btn btn-primary btn-sm"><span class="glyphicon glyphicon-log-out" aria-hidden="true"></span> Salir</button>
    </div>
</div>
<div class="modal fade" id="confirmarEliminar" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header centrado">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="myModalLabel">Mensaje del Sistema</h4>
            </div>
            <div class="modal-body">
                Est√° seguro de eliminar estos datos?
            </div>
            <div class="modal-footer centrado">
                <button id="botonEliminarAlert" type="button" class="btn btn-primary btn-sm">Eliminar</button>
                <button type="button" class="btn btn-default btn-sm" data-dismiss="modal">Cancelar</button>
            </div>
        </div>
    </div>
</div>
<script src="frm/crm/definiciones/permisos/js/funciones.js" type="text/javascript"></script>
<script>
    verificar_sesion_ajax();
    $("#buscar").css("display", "none");
    $("#id_rol").focus();
    siguiente_campo("#id_formulario", "#botonBuscarIdFormulario", true);
    siguiente_campo("#id_rol", "#id_formulario", false);
    $("#botonBuscarIdPermiso").on('click', function () {
        $("#buscar").load("buscar.html");
        $("#buscar").fadeIn("slow");
        $("#panelPrograma").fadeOut("slow");
    });
    $("#botonBuscarIdRol").on('click', function () {
        $("#buscar").load("frm/crm/definiciones/permisos/buscarRoles.html");
        $("#buscar").fadeIn("slow");
        $("#panelPrograma").fadeOut("slow");
    });
    $("#botonBuscarIdFormulario").on('click', function () {
        $("#buscar").load("frm/crm/definiciones/permisos/buscarFormularios.html");
        $("#buscar").fadeIn("slow");
        $("#panelPrograma").fadeOut("slow");
    });
    $("#btn-agregar-permiso").on('click', function () {
        var id_rol = $("#id_rol").val();
        var id_formulario = $(this).parent().siblings().eq(0).find("input").val();
        var agregar = $(this).parent().siblings().eq(2).find("input").prop("checked");
        var modificar = $(this).parent().siblings().eq(3).find("input").prop("checked");
        var eliminar = $(this).parent().siblings().eq(4).find("input").prop("checked");
        var listar = $(this).parent().siblings().eq(5).find("input").prop("checked");
        if (id_rol === "") {
            mostrar_mensaje("#id_formulario", "danger", "Dato Incompleto", "Debe seleccionar un Formulario");
        } else {
            agregarPermiso(id_rol, id_formulario, agregar, modificar, eliminar, listar);
        }
    });
    $("#botonEliminarAlert").on('click', function () {
        eliminarPermiso();
        $('#confirmarEliminar').modal('hide');
    });
    $("#botonSalir").on('click', function () {
        $('aside').html("");
    });
</script>

